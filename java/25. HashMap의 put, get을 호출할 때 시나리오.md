## 25. HashMapì˜ put, getì„ í˜¸ì¶œí•  ë•Œ ì‹œë‚˜ë¦¬ì˜¤

### ğŸ§  ê°œë… ì„¤ëª…
**put()**

```java
public V put(K key, V value) {
        return putVal(hash(key), key, value, false, true);
    }

final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node<K,V>[] tab; Node<K,V> p; int n, i;
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((p = tab[i = (n - 1) & hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        else {
            Node<K,V> e; K k;
            if (p.hash == hash &&
                ((k = p.key) == key || (key != null && key.equals(k))))
                e = p;
            else if (p instanceof TreeNode)
                e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);
            else {
                for (int binCount = 0; ; ++binCount) {
                    if ((e = p.next) == null) {
                        p.next = newNode(hash, key, value, null);
                        if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    }
                    if (e.hash == hash &&
                        ((k = e.key) == key || (key != null && key.equals(k))))
                        break;
                    p = e;
                }
            }
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            }
        }
        ++modCount;
        if (++size > threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    }
```

1. key ì˜ hashCode() í˜¸ì¶œ
2. í…Œì´ë¸”ì´(transient Node<K,V>[] table) ë¹„ì–´ ìˆìœ¼ë©´ resize() ë¡œ ê¸°ë³¸ í¬ê¸°ë¡œ ì´ˆê¸°í™”í•œë‹¤
3. í•´ì‹œê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ê²°ì •
4. í•´ë‹¹ ìœ„ì¹˜ê°€ ë¹„ì–´ ìˆë‹¤ë©´ ìƒˆ ë…¸ë“œ ì‚½ì…
5. ë§Œì•½ ìˆë‹¤ë©´
  - 5.1. ë™ì¼í•œ í‚¤ë¼ë©´ ê°’ë§Œ ë®ì–´ì“°ê¸°
  - 5.2. ë§Œì•½ ë²„í‚·ì´ TreeNode ë¼ë©´ íŠ¸ë¦¬ì— ì‚½ì…
  - 5.3. ì—°ê²° ë¦¬ìŠ¤íŠ¸ë¼ë©´ ë§¨ ëê¹Œì§€ ìˆœíšŒ í›„ ì‚½ì…
6. ë™ì¼í•œ í‚¤ê°€ ìˆìœ¼ë©´ ê°’ë§Œ ë®ì–´ì“°ê³  ê¸°ì¡´ ê°’ ë°˜í™˜
   
<br/>

**get()**
```java
public V get(Object key) {
        Node<K,V> e;
        return (e = getNode(key)) == null ? null : e.value;
    }

final Node<K,V> getNode(Object key) {
        Node<K,V>[] tab; Node<K,V> first, e; int n, hash; K k;
        if ((tab = table) != null && (n = tab.length) > 0 &&
            (first = tab[(n - 1) & (hash = hash(key))]) != null) {
            if (first.hash == hash && // always check first node
                ((k = first.key) == key || (key != null && key.equals(k))))
                return first;
            if ((e = first.next) != null) {
                if (first instanceof TreeNode)
                    return ((TreeNode<K,V>)first).getTreeNode(hash, key);
                do {
                    if (e.hash == hash &&
                        ((k = e.key) == key || (key != null && key.equals(k))))
                        return e;
                } while ((e = e.next) != null);
            }
        }
        return null;
    }
```

1. í•´ì‹œ í…Œì´ë¸”ê³¼ ê´€ë ¨ ê°’ ì´ˆê¸°í™”
  - tab : ë‚´ë¶€ í•´ì‹œ í…Œì´ë¸”
  - first : í•´ì‹œ ì¸ë±ìŠ¤ì— ìœ„ì¹˜í•œ ì²« ë²ˆì§¸ ë…¸ë“œ
  - e : íƒìƒ‰ìš© ë³€ìˆ˜
  - hash : í‚¤ì˜ í•´ì‹œê°’

2. í•´ì‹œ í…Œì´ë¸”ì´ ì¡´ì¬í•˜ê³  í•´ë‹¹ í•´ì‹œ ì¸ë±ìŠ¤ì˜ ì²« ë…¸ë“œê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ 
3. ì²« ë²ˆì§¸ ë…¸ë“œê°€ ì°¾ëŠ” í‚¤ì™€ ê°™ì€ì§€ í™•ì¸
4. ì¶©ëŒë¡œ ì¸í•´ ì—°ê²° ë¦¬ìŠ¤íŠ¸ê°€ ìˆì„ê²½ìš° íŠ¸ë¦¬ êµ¬ì¡°ë©´ íŠ¸ë¦¬ íƒìƒ‰ì„ í•œë‹¤.
5. ì—°ê²° ë¦¬ìŠ¤íŠ¸ êµ¬ì¡°ë¼ë©´ ìˆœì°¨ íƒìƒ‰

<br/>


**ì¶©ëŒì´ ì¼ì–´ë‚˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ê°€**

1. ì²´ì´ë‹ìœ¼ë¡œ ì—°ê²° ë¦¬ìŠ¤íŠ¸ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.
2. ë§Œì•½ ì—°ê²° ë¦¬ìŠ¤íŠ¸ ê¸¸ì´ê°€ 8 ì´ìƒì¸ ê²½ìš°, HashMap ë‚´ë¶€ ë°°ì—´ì˜ ê° ì¹¸ì¸ ë²„í‚·ì´ 64ê°œê°€ ë„˜ì–´ê°€ë©´ íŠ¸ë¦¬êµ¬ì¡°ë¡œ ì „í™˜
  - í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ë¥¼ red-black íŠ¸ë¦¬ë¡œ ë³€í™˜í•˜ì—¬ íƒìƒ‰ ì„±ëŠ¥ì„ o(n) -> o(log n)ìœ¼ë¡œ ê°œì„  í•œë‹¤.
3. ë§Œì•½ ì—°ê²° ë¦¬ìŠ¤íŠ¸ ë…¸ë“œ ìˆ˜ê°€ 8 ì´ìƒì´ì§€ë§Œ ë²„í‚·ì´ 64ë¯¸ë§Œì´ë©´ íŠ¸ë¦¬í™”í•˜ì§€ ì•Šê³  ì˜¤íˆë ¤ resize()ë¥¼ ìˆ˜í–‰í•´ì„œ ë°°ì—´ ìš©ëŸ‰ì„ ëŠ˜ë¦°ë‹¤

<br/>

---
### âœ… í•œì¤„ë¡œ ì„¤ëª… í•˜ê¸°

- put() ì€ keyì˜ í•´ì‹œê°’ìœ¼ë¡œ ë²„í‚· ìœ„ì¹˜ë¥¼ ì°¾ì•„ ì¶©ëŒ ì—¬ë¶€ì— ë”°ë¼ì„œ ì‚½ì…í•˜ê±°ë‚˜ ë®ì–´ì“°ê¸°, íŠ¸ë¦¬ ë³€í™˜ì„ ì²˜ë¦¬í•˜ë©° í•„ìš”ì‹œ ë¦¬ì‚¬ì´ì¦ˆë„ ìˆ˜í–‰í•œë‹¤.
- get() ì€ í‚¤ì˜ í•´ì‹œê°’ìœ¼ë¡œ í…Œì´ë¸” ì¸ë±ìŠ¤ë¥¼ ê³„ì‚°í•˜ê³  í•´ë‹¹ ë²„í‚·ì˜ ì²« ë…¸ë“œë¥¼ ë¨¼ì € í™•ì¸í•œ ë’¤ í•„ìš”í•˜ë©´ ì—°ê²° ë¦¬ìŠ¤íŠ¸ë‚˜ íŠ¸ë¦¬ë¥¼ ë”°ë¼ê°€ë©´ì„œ í‚¤ë¥¼ ë¹„êµí•˜ì—¬ ê°’ì„ ë°˜í™˜í•œë‹¤.
