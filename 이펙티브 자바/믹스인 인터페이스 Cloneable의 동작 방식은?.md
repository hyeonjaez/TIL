## 믹스인 인터페이스 Cloneable의 동작 방식은?

### 🧠 개념 설명
**믹스인 (Mixin)**
- 상속이나 조합만으로는 제공하기 어려운 부가적인 기능이나 특성을 클래스에 섞어 넣는 개념
- 자바에서는 보통 인터페이스를 구현함으로써 해당 성질을 부여한다
- 구현해야 한다가 아니라 이 클래스는 이런 성질을 가진다라고 표시하는 용도

**믹스인 인터페이스**
- 작업을 수행하기 위한 계약이 아니라 특성이나 역할을 표시하거나 부가 기능을 부여하는 것
- 메서드가 없어도 됨
- 구현 목적이 아닌 해당 클래스가 어떤 성질을 가지는지

<br/>

**Cloneable**
- 자바의 믹스인 인터페이스 중 하나
- 이 인터페이스를 implements하면 이 클래스는 안전하게 복제 할수 있다라는 의미만 전달

<br/>

**동작 방식**

1. Object.clone() 호출
  - Object 클래스에 protected native Object clone() throws CloneNotSupportedException 정의 되어 있다
  - 이 메서드는 객체의 필드 단위 복사를 수행한다
2. Cloneable 인터페이스와의 관계
  - 만약 Cloneable를 구현하지 않은 클래스에서 clone()을 호출하게 된다면 CloneNotSupportedException 발생
  - Cloneable을 구현한 클래스에서 clone()을 호출하면 → Object.clone()이 정상 동작

3. 복제된 객체 반환
  - 새 객체는 원본과 동일한 값을 가진 복사본이지만 별도의 메모리 주소를 가진다
  - 하지만 참조 타입 필드는 얕은 복사를 해서 동일한 인스턴스를 가리키게 된다

**Cloneable의 역할**
  - 이 객체를 복사해도 된다라는 것을 알려주는 것이고
  - 실질적인 복제 로직은 Object.clone()에서 처리한다

<br/>

**주의사항**
- 얕은 복사 : 참조 타입 필드는 같은 인스턴스를 가리켜서 깊은복사는 별도의 구현이 필요하다
- 복제 시에 생성자가 실행되지 않아서 불변성이 깨질수 있다
- 설계상 권장하지 않는다. 복사 생성자나 정적 팩토리 메서드를 권장한다

<br/>

**왜 복사 생성자나 정적 팩토리 메서드를 권장하는 이유**
- clone 방식의 문제점 때문이다
  - 1. Cloneable은 마커 인터페이스인데 실제 동작은 Object.clone()에 의존한다
    2. 얕은 복사
    3. 생성자를 호출하지 않아 생성자에서 보장하던 검증이나 초기화 로직이 무시될수 있어 불변식이 깨질수 있다
    4. Object.clone은 Checked Exception을 던진다 하지만 절대 발생하지 않는다 그래서 억지로 처리해야한다
