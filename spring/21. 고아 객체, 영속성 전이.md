## 21. 고아 객체, 영속성 전이

### 🧠 개념 설명
**고아 객체**
- 부모 엔티티와의 연관관계가 끊겨서 더 이상 참조되지 않는 자식 엔티티를 말한다
- JPA에서는 연관관계가 끊겨도 자식 엔티티를 DB에서 삭제 하지 않는다 -> 단순하게 외래키가 null이 될뿐이다.


**영속성 전이 Cacade**
- 부모 엔티티의 영속 상태 변화를 자식 엔티티에 전이하는 기능이다.
- CascadeType.PERSIST : 부모 저장시 자식도 함께 저장
- CascadeType.REMOVE : 부모 삭제 시 자식도 함께 삭제
- 주로 생명주기를 함께 관리하는 경우에 사용한다

**고아 객체 제거**
- 고아 객체 설정과 영속성 전이를 함께 사용하게 된다고 했을때
- 부모 엔티티에서 자식 엔티티 참조를 제거하면 해당 자식 엔티티를 DB에서도 삭제를 한다
- 동작 방식
    1. 부모와 자식의 연관관계가 끊어짐
    2. JPA가 해당 자식을 고아 객체로 인식한다
    3. 트랜잭션 커밋 시 DB에서 DELETE한다
 
**영속성 전이 + 고아객체 생명주기**
- 조합 사용시 특징
  - 부모 저장시 -> 자식도 함께 저장
  - 부모 삭제시 -> 자식도 함께 삭제
  - 부모 컬렉션에서 제거시에 자식은 자동 삭제(고아 객체 제거)

---
### ✅ 한줄로 설명 하기
- 영속성 전이 Cascade는 특정 엔티티를 영속 상태로 만들때 연관된 엔티티도 함께 영속 상태로 만드는 거다
- 고아 객체는 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 고아 객체라고 한다 DB에서는 단순하게 외래키가 null이 된다
  - JPA에서 이것을 삭제하는 기능을 고아 객체 제거라한다
- 둘다 사용했을때 부모가 자식의 생명주기를 완전하게 관리한다
