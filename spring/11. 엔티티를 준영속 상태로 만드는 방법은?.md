## 11. 엔티티를 준영속 상태로 만드는 방법은?

### 🧠 개념 설명
**엔티티 생명주기**
1. 비영속 : 영속성 컨텍스트와 전혀 관계 없음
2. 영속 : em.persist() 로 영속성 컨텍스트에 관리됨
3. 준영속 : 영속 상태였다가 더 이상 영속성 컨텍스트가 관리하지 않는 상태
4. 삭제 : 영속성 컨텍스트와 DB에서 삭제 예약 상태


**준영속 상태로 만드는 방법**
1. em.detach(entity)
  - 특정 엔티티만 준영속 상태로 만든다
2. em.clear()
  - 영속성 컨텍스트 전체 초기화
4. em.close()
  - 엔티티 매니저 종료
  - 영속성 컨텍스트 자체를 종료


**준영속 상태 특징**
- 더 이상 1차 캐시, Dirty Checking, 쓰기 지연 등의 JPA 기능 못씀
- DB 반영 안됨
- 다시 영속 상태로 만들려면 em.merge() 를 써야함


<br/>


**준영속 vs 삭제**
준영속 
  - 준영속은 영속성 컨텍스트의 관리에만 벗어난 상태이다
  - 객체는 메모리에 존재하지만 변경을 추적하지 않음
  - 필요하다면 다시 영속 상태로 재등록 가능하다 

삭제
  - 영속성 컨텍스으에서 제거됨
  - 커밋 시 DELETE 가 실행됨
  - 객체 자체는 메모리에 남아 있지만 JPA는 DB에서 삭제할 준비를 함 

**왜 필요할까?**
- 객체는 남겨두는데 DB에서 실제로 지우고 싶지 않을 경우
- 많은 데이터 조회 시 영속성 컨텍스트에 계속 쌓이면 메모리가 쓰이고 Dirty Checking 비용이 커진다
- 특정 객체는 조회만 하고 수정/삭제 는 하지 않게 하고 싶을때

---
### ✅ 한줄로 설명 하기
- 준영속 상태는 영속성 컨텍스트 관리에서만 벗어난 상태이다.
- 만드는 방법은 특정 엔티티만 :detach(), 모든 엔티티 : clear(), 엔티티 매니저 종료 시 : close()
